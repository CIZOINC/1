"use strict";function AppCtrl(e,t,r,n){e.title="Cizo",e.versionAPI="v1",e.hostName="http://staging.cizo.com",applicationStart(t,r,n)}function applicationStart(e,t,r){e.configureStates(t),r.go("main")}function _lodash(e){return _}function _moment(e){return moment}function routerHelperProvider(e,t,r){function n(e){function n(e,n){e.forEach(function(e){t.state(e.state,e.config)}),n&&!o&&(o=!0,r.otherwise(n))}function a(){return e.get()}var o=!1;return{configureStates:n,getStates:a}}this.$get=n,n.$inject=["$state"]}function imageUploader(e,t,r,n,a){function o(o,i){var l=angular.element(document.querySelector("image-uploader .image-drop-zone"));t.each(o,function(t){var o=3e3,s=["image/jpeg","image/pjpeg","image/png","image/bmp"];return s.indexOf(t.type)<0?(e.warn("Unsupported file format"),l.text("Unsupported file format"),l.addClass("error"),void r(function(){l.text("Click to select image for uploading"),l.removeClass("error")},o)):(Number(n.id)&&a.uploadHeroImage(i,Number(n.id),t),void l[0].classList.remove("drop"))})}function i(e){var t=angular.element(document.querySelector("image-uploader .image-drop-zone")),r=angular.element(document.querySelector("image-uploader .image-file-input"));t.on("click",function(){var e=angular.element(document.querySelector("image-uploader .image-file-input"));e[0].click()}),t.on("dragover",function(e){return e.preventDefault(),t[0].classList.add("hover"),!1}),t.on("dragleave",function(e){return e.preventDefault(),t[0].classList.remove("hover"),!1}),t.on("drop",function(r){if(r.stopPropagation(),r.preventDefault(),t[0].classList.remove("hover"),t[0].classList.add("drop"),r&&r.dataTransfer&&r.dataTransfer.files){var n=r.dataTransfer.files;o(n,e)}return!1}),r.on("change",function(){var t=angular.element(document.querySelector("image-uploader .image-file-input"))[0].files;o(t,e)})}return{restrict:"E",templateUrl:"components/image_upload/imageUploader.html",link:i,scope:{hostLink:"=link"}}}function player(e,t){function r(){}function n(n,a,o){function i(){var t=angular.element(document.querySelector("video.screen"))[0],r=angular.element(document.querySelector("div.play-button span"))[0];t.paused?(t.play(),e.info("start playing"),r.classList.add("glyphicon-play"),r.classList.remove("glyphicon-pause"),n.$apply()):(t.pause(),e.info("set to pause"),r.classList.add("glyphicon-pause"),r.classList.remove("glyphicon-play"),n.$apply())}var l=angular.element(document.querySelector("video.screen"));l.on("click",r),l.on("timeupdate",function(){n.timePassed=t().startOf("year").add(l[0].currentTime,"s").format("mm:ss"),n.duration=t().startOf("year").add(l[0].duration,"s").format("mm:ss"),n.$apply()});var s=angular.element(document.querySelector("div.play-button span"));s.on("click",i)}return{restrict:"E",templateUrl:"components/player/player.html",link:n,transclude:!0,scope:{width:"@"}}}function sidebar(e){function t(t){e.info("linked")}return{restrict:"E",templateUrl:"components/sidebar/sidebar.html",link:t,transclude:!0,scope:{}}}function uploader(e,t,r,n,a,o){function i(i,l){var s=angular.element(document.querySelector(".drop-zone"));t.each(i,function(t){var i=3e3;return"video/mp4"!==t.type?(e.warn("Unsupported file format"),s.text("Unsupported file format"),s.addClass("error"),void r(function(){s.text("Click to select file for uploading"),s.removeClass("error")},i)):(Number(a.id)&&n.sendRequest(Number(a.id),t.name,l.hostLink).then(function(r){var i=(document.querySelector("form"),angular.element(document.querySelector(".drop-zone")));i.text("File is uploading. Please wait"),i.addClass("upload");var s=new FormData;s.append("key",r.data.key),s.append("Expires",r.data.Expires),s.append("policy",r.data.policy),s.append("x-amz-credential",r.data["x-amz-credential"]),s.append("x-amz-algorithm",r.data["x-amz-algorithm"]),s.append("x-amz-date",r.data["x-amz-date"]),s.append("x-amz-security-token",r.data["x-amz-security-token"]),s.append("x-amz-signature",r.data["x-amz-signature"]),s.append("file",t),o.post(r.data.url,s,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).then(function(){e.info("success"),n.updateStreams(id,link).then(function(){i.text("Click to select file for uploading"),i.removeClass("upload")})},function(){e.info("failure"),n.updateStreams(Number(a.id),l.hostLink).then(function(){i.text("Click to select file for uploading"),i.removeClass("upload")})})}),void s[0].classList.remove("drop"))})}function l(e){var t=angular.element(document.querySelector(".drop-zone")),r=angular.element(document.querySelector(".file-input"));t.on("click",function(){var e=angular.element(document.querySelector(".file-input"));e[0].click()}),t.on("dragover",function(e){return e.preventDefault(),t[0].classList.add("hover"),!1}),t.on("dragleave",function(e){return e.preventDefault(),t[0].classList.remove("hover"),!1}),t.on("drop",function(r){if(r.stopPropagation(),r.preventDefault(),t[0].classList.remove("hover"),t[0].classList.add("drop"),r&&r.dataTransfer&&r.dataTransfer.files){var n=r.dataTransfer.files;i(n,e)}return!1}),r.on("change",function(){var t=angular.element(document.querySelector(".file-input"))[0].files;i(t,e)})}return{restrict:"E",templateUrl:"components/uploader/uploader.html",link:l,transclude:!0,scope:{hostLink:"=link",postData:"@"}}}function uploaderServ(e,t,r){function n(e){var t=e.toLowerCase();return t=t.replace(/^[^a-z0-9]/g,""),t=t.replace(/[^a-z0-9\-\.]/g,"_"),t.length>25&&(t=t.substr(0,25)),t}function a(a,o,i){return t(function(t,l){function s(e){r.info("request data received"),r.info(JSON.stringify(e)),t(e)}function d(e){r.info("request data receiving error with status "+e.status),l(e)}e({method:"GET",url:i+"/videos/"+a+"/raw_stream_upload_request",params:{filename:n(o)}}).then(s,d)})}function o(t,r){return e({method:"POST",url:r+"/videos/"+t+"/streams"})}return{sendRequest:a,updateStreams:o}}function CategoriesCtrl(e,t,r,n){n.getCategoriesList(e).then(function(r){e.categoriesList=r.data.data,t.info("data received")},function(e){t.error("receiving error happened: "+e)}),e.deleteCategory=function(t){n.deleteCategory(e,t).then(function(){r.go(r.current,{},{reload:!0})})}}function CategoryCtrl(e,t,r,n,a){e.screenTitle=Number(n.id)>0?"Edit":"Create",Number(n.id)&&a.getCategory(e,n.id).then(function(r){e.categoryItem=r.data,t.info("data received")},function(e){t.error("receiving error happened: "+e)}),e.updateCategory=function(){Number(n.id)?a.setCategory(e,n.id,e.categoryItem).then(function(){t.info("successfully sent"),r.go("categories")},function(e){t.info("error happened with status "+e.status)}):a.makeCategory(e,e.categoryItem).then(function(){r.go("categories")})}}function categoriesServ(e,t,r){function n(n){return t(function(t,a){function o(e){r.info("categories list obtained"),t(e)}function i(e){r.info("categories list obtaining error with status "+e.status),a(e)}e({method:"GET",url:n.hostName+"/categories"}).then(o,i)})}function a(n,a){return t(function(t,o){function i(e){r.info("category data created"),t(e)}function l(e){r.info("category data creation error with status "+e.status),o(e)}e({method:"POST",url:n.hostName+"/categories",data:a}).then(i,l)})}function o(n,a){return t(function(t,o){function i(e){r.info("category data delivered"),t(e)}function l(e){r.info("category data getting error with status "+e.status),o(e)}e({method:"GET",url:n.hostName+"/categories/"+a}).then(i,l)})}function i(n,a,o){return t(function(t,i){function l(e){r.info("category data updated"),t(e)}function s(e){r.info("category data updating error with status "+e.status),i(e)}e({method:"PUT",url:n.hostName+"/categories/"+a,data:o}).then(l,s)})}function l(n,a){return t(function(t,o){function i(e){r.info("category data deleted"),t(e)}function l(e){r.info("category data deleting error with status "+e.status),o(e)}e({method:"DELETE",url:n.hostName+"/categories/"+a}).then(i,l)})}return{getCategoriesList:n,makeCategory:a,getCategory:o,setCategory:i,deleteCategory:l}}function ContentCtrl(e,t,r,n){n.getVideosList(e).then(function(r){e.videosList=r.data.data,t.info("data received")},function(e){t.error("receiving error happened: "+e)}),e.deleteVideo=function(t){n.deleteVideo(e,t).then(function(){r.go(r.current,{},{reload:!0})})}}function MainCtrl(e,t){e.trending="Trending",e.categories="Categories",e.videos="Videos"}function UploadCtrl(e,t){}function VideoCtrl(e,t,r,n,a,o){function i(){o.getCategoriesList(e).then(function(t){e.categoriesList=t.data.data,l()},function(e){t.error("receiving error happened: "+e),l()})}function l(){Number(n.id)?a.getVideo(e,n.id).then(function(r){e.videoItem=r.data,e.videoItem.category_id=String(r.data.category_id),e.createdDate=moment(e.videoItem.created_at).format("MM.DD.YYYY HH:mm"),e.updatedDate=moment(e.videoItem.updated_at).format("MM.DD.YYYY HH:mm"),t.info("data received")},function(e){t.error("receiving error happened: "+e)}):(e.createdDate=moment().format("MM.DD.YYYY HH:mm"),e.updatedDate=moment().format("MM.DD.YYYY HH:mm"))}e.mpaaRatingList=["G","PG","PG-13","R","NC-17"],e.screenTitle=Number(n.id)>0?"Edit":"Create",e.hostNameUpload=e.hostName,i(),e.updateVideo=function(){Number(n.id)?(e.videoItem.updated_at=new Date,a.setVideo(e,n.id,e.videoItem).then(function(){t.info("successfully sent"),r.go("content")},function(e){t.info("error happened with status "+e.status)})):(e.videoItem.created_at=new Date,e.videoItem.updated_at=new Date,e.videoItem.tags=[],a.makeVideo(e,e.videoItem).then(function(){r.go("content")}))}}function videoServ(e,t,r){function n(n){return t(function(t,a){function o(e){r.info("video list obtained"),t(e)}function i(e){r.info("video list obtaining error with status "+e.status),a(e)}e({method:"GET",url:n.hostName+"/videos"}).then(o,i)})}function a(n,a){return t(function(t,o){function i(e){r.info("video data created"),t(e)}function l(e){r.info("video data creation error with status "+e.status),o(e)}e({method:"POST",url:n.hostName+"/videos",data:a}).then(i,l)})}function o(n,a){return t(function(t,o){function i(e){r.info("video data delivered"),t(e)}function l(e){r.info("video data getting error with status "+e.status),o(e)}e({method:"GET",url:n.hostName+"/videos/"+a}).then(i,l)})}function i(n,a,o){return t(function(t,i){function l(e){r.info("video data updated"),t(e)}function s(e){r.info("video data updating error with status "+e.status),i(e)}var d=angular.toJson(o);e({method:"PUT",url:n.hostName+"/videos/"+a,data:d}).then(l,s)})}function l(n,a){return t(function(t,o){function i(e){r.info("video data deleted"),t(e)}function l(e){r.info("video data deleting error with status "+e.status),o(e)}e({method:"DELETE",url:n.hostName+"/videos/"+a}).then(i,l)})}function s(n,a,o){var i=new FormData;return i.append("file",o),t(function(t,o){function l(e){r.info("hero image uploaded"),t(e)}function s(e){r.info("hero image uploading error with status "+e.status),o(e)}e.post(n.hostLink+"/videos/"+a+"/hero_image",i,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).then(l,s)})}return{getVideosList:n,makeVideo:a,getVideo:o,setVideo:i,deleteVideo:l,uploadHeroImage:s}}function WatchCtrl(e,t,r,n){var a;t.link&&(a=r.trustAs(r.RESOURCE_URL,t.link.replace(/%2F/g,"/"))),e.page="Watch",e.playerSettings={width:n.innerWidth,link:a}}angular.module("app.controls",["ngSanitize"]),angular.module("app.services",[]),angular.module("app.directives",["app.services"]),angular.module("templates",[]),angular.module("app",["app.services","app.controls","app.directives","app.routerHelper","app.wrappers","app.routes","ngSanitize","templates"]).controller("AppCtrl",AppCtrl),AppCtrl.$inject=["$scope","routerHelper","routesList","$state"],angular.module("app.helpers",[]).factory("RecursionHelper",["$compile",function(e){return{compile:function(t,r){angular.isFunction(r)&&(r={post:r});var n,a=t.contents().remove();return{pre:r&&r.pre?r.pre:null,post:function(t,o){n||(n=e(a)),n(t,function(e){o.append(e)}),r&&r.post&&r.post.apply(null,arguments)}}}}}]),angular.module("templates").run(["$templateCache",function(e){e.put("index_template.html",'<!DOCTYPE html>\r\n<html lang="en">\r\n<head>\r\n    <meta charset="UTF-8">\r\n    <title>Cizo</title>\r\n    <link rel="stylesheet" href="all.min.css">\r\n</head>\r\n<body ng-controller="AppCtrl">\r\n<sidebar>\r\n    <li>Manage Users</li>\r\n    <li ui-sref="content">Content</li>\r\n    <li ui-sref="categories">Categories</li>\r\n    <li>Settings</li>\r\n</sidebar>\r\n\r\n<div ui-view class="main-view"></div>\r\n\r\n\r\n<script src="3d-party.min.js"></script>\r\n<script src="ng.min.js"></script>\r\n\r\n<script>\r\n    angular.bootstrap(document, [\'app\']);\r\n</script>\r\n\r\n\r\n</body>\r\n</html>'),e.put("components/image_upload/imageUploader.html",'<div class="image-drop-zone">\r\n    Click to select image for uploading\r\n</div>\r\n<form>\r\n    <input type="file" class="image-file-input" name="file" />\r\n</form>'),e.put("components/player/player.html",'<div class="container">\r\n    <video class="screen" width="{{width}}" autoplay  ng-transclude></video>\r\n    <div class="like-button">\r\n        <span class="glyphicon glyphicon-heart-empty"></span>\r\n    </div>\r\n    <div class="play-button">\r\n        <span class="glyphicon glyphicon-play"></span>\r\n    </div>\r\n    <div class="info-panel">\r\n        <span>{{timePassed}} / {{duration}}</span>\r\n    </div>\r\n</div>'),e.put("components/sidebar/sidebar.html",'<h1>\r\n    <a href="#/">\r\n        <img src="images/cizo-logo.svg" alt="Cizo">\r\n\r\n    </a>\r\n    <span>Admin Panel</span>\r\n</h1>\r\n\r\n<ul ng-transclude class="menu-list"></ul>'),e.put("components/uploader/uploader.html",'<div class="drop-zone">\r\n    Click to select file for uploading\r\n</div>\r\n<form>\r\n    <input type="file" class="file-input" name="file" />\r\n</form>'),e.put("temp/final/index.html",'<!DOCTYPE html>\r\n<html lang="en">\r\n<head>\r\n    <meta charset="UTF-8">\r\n    <title>Cizo</title>\r\n    <link rel="stylesheet" href="all.min.css">\r\n</head>\r\n<body ng-controller="AppCtrl">\r\n<sidebar>\r\n    <li>Manage Users</li>\r\n    <li ui-sref="content">Content</li>\r\n    <li ui-sref="categories">Categories</li>\r\n    <li>Settings</li>\r\n</sidebar>\r\n\r\n<div ui-view class="main-view"></div>\r\n\r\n\r\n<script src="3d-party.min.js"></script>\r\n<script src="ng.min.js"></script>\r\n\r\n<script>\r\n    angular.bootstrap(document, [\'app\']);\r\n</script>\r\n\r\n\r\n</body>\r\n</html>'),e.put("views/categories/categories.html",'<div>\r\n    <h2>Categories</h2>\r\n    <div>\r\n\r\n        <button class="btn btn-lg" ui-sref="category({id: 0})">Add category</button>\r\n\r\n        <div class="list-group">\r\n            <div class="list-group-item" ng-repeat="item in categoriesList">\r\n                <div class="list-group-item-heading">{{item.title}}</div>\r\n                <a ui-sref="category({id: item.id })">Edit</a>\r\n                <a ng-click="deleteCategory(item.id)">Delete</a>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'),e.put("views/categories/category.html",'<div class="container">\r\n    <h2>{{screenTitle}} Category</h2>\r\n    <div class="row">\r\n        <div class="col-sm-8">\r\n            <div class="row">\r\n                <label class="col-md-offset-3 col-sm-3">Title</label>\r\n                <input class="col-sm-6" ng-model="categoryItem.title" required>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n    <button ng-click="updateCategory()">Update category</button>\r\n\r\n</div>'),e.put("views/content/content.html",'<div>\r\n    <h2>Videos</h2>\r\n    <div>\r\n\r\n        <button class="btn btn-lg" ui-sref="video({id: 0})">Add video</button>\r\n\r\n        <div class="list-group">\r\n            <div class="list-group-item" ng-repeat="movie in videosList">\r\n                <div class="list-group-item-heading">{{movie.title}}</div>\r\n                <div class="list-group-item-text">{{movie.description}}</div>\r\n                {{movie.streams.link}}\r\n                <a ui-sref="video({id: movie.id })">Edit</a>\r\n                <a ng-click="deleteVideo(movie.id)">Delete</a>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'),e.put("views/main/main.html",'<div>\r\n    <div class="btn-group-vertical">\r\n\r\n    </div>\r\n</div>'),e.put("views/upload/upload.html",'<h1>Upload video</h1>\r\n\r\n<uploader></uploader>\r\n\r\n<button class="btn btn-lg btn-success" ui-sref="content">Apply</button>\r\n<button class="btn btn-lg btn-danger" ui-sref="content">Cancel</button>'),e.put("views/video/video.html",'<div class="container">\r\n    <h2>{{::screenTitle}} Video</h2>\r\n    <div class="row">\r\n        <div class="col-sm-8">\r\n            <div class="row">\r\n                <label class="col-md-offset-3 col-sm-3">Created</label>\r\n                <span class="col-sm-6">{{::createdDate}}</span>\r\n            </div>\r\n            <div class="row">\r\n                <label class="col-md-offset-3 col-sm-3">Last Update</label>\r\n                <span class="col-sm-6">{{::updatedDate}}</span>\r\n            </div>\r\n            <div class="row">\r\n                <label class="col-md-offset-3 col-sm-3">Title</label>\r\n                <input class="col-sm-6" ng-model="videoItem.title" required>\r\n            </div>\r\n            <div class="row">\r\n                <label class="col-md-offset-3 col-sm-3">Description</label>\r\n                <textarea class="col-sm-6" ng-model="videoItem.description" required></textarea>\r\n            </div>\r\n            <div class="row">\r\n                <label class="col-md-offset-3 col-sm-3">Rating</label>\r\n                <select class="col-sm-6" ng-model="videoItem.mpaa_rating" ng-options="rate for rate in mpaaRatingList" required></select>\r\n            </div>\r\n            <div class="row">\r\n                <label class="col-md-offset-3 col-sm-3">Category</label>\r\n                <select class="col-sm-6" ng-model="videoItem.category_id" required>\r\n                    <option ng-repeat="option in categoriesList" value="{{option.id}}">{{option.title}}</option>\r\n                </select>\r\n            </div>\r\n            <div class="row">\r\n                <label class="col-md-offset-3 col-sm-3">Viewable</label>\r\n                <input type="checkbox" class="col-sm-6" ng-model="videoItem.viewable"></input>\r\n            </div>\r\n        </div>\r\n        <div class="col-sm-4">\r\n            <div class="row">\r\n                <label class="col-sm-3">Video</label>\r\n            </div>\r\n            <div class="row">\r\n                <uploader link="hostNameUpload"></uploader>\r\n            </div>\r\n            <div class="row">\r\n                <label class="col-sm-3">Hero Image</label>\r\n            </div>\r\n            <div class="row">\r\n                <image-uploader link="hostNameUpload"></image-uploader>\r\n            </div>\r\n        </div>\r\n    </div>\r\n   <button ng-click="updateVideo()">Update video</button>\r\n\r\n</div>'),e.put("views/watch/watch.html",'<!--<video autoplay preload="auto" width="{{playerSettings.width}}">\r\n    <source src="{{playerSettings.link}}">\r\n</video>-->\r\n\r\n<player width="{{playerSettings.width}}">\r\n    <source src="{{playerSettings.link}}">\r\n</player>')}]),angular.module("app.wrappers",[]).factory("lodash",_lodash),_lodash.$inject=["$log"],angular.module("app.wrappers").factory("moment",_moment),_moment.$inject=["$log"],angular.module("app.routerHelper",["ui.router"]).provider("routerHelper",routerHelperProvider),routerHelperProvider.$inject=["$locationProvider","$stateProvider","$urlRouterProvider"],angular.module("app.routes",[]).constant("routesList",[{state:"main",config:{url:"/",templateUrl:"views/main/main.html",controller:"MainCtrl",controllerAs:"main"}},{state:"content",config:{url:"/content",templateUrl:"views/content/content.html",controller:"ContentCtrl",controllerAs:"content"}},{state:"video",config:{url:"/video/:id",templateUrl:"views/video/video.html",controller:"VideoCtrl",controllerAs:"video"}},{state:"upload",config:{url:"/upload/:id",templateUrl:"views/upload/upload.html",controller:"UploadCtrl",controllerAs:"upload"}},{state:"categories",config:{url:"/categories",templateUrl:"views/categories/categories.html",controller:"CategoriesCtrl",controllerAs:"categories"}},{state:"category",config:{url:"/category/:id",templateUrl:"views/categories/category.html",controller:"CategoryCtrl",controllerAs:"category"}}]),angular.module("app.directives").directive("imageUploader",imageUploader),imageUploader.$inject=["$log","lodash","$timeout","$stateParams","videoServ"],angular.module("app.directives").directive("player",player),player.$inject=["$log","moment"],angular.module("app.directives").directive("sidebar",sidebar),sidebar.$inject=["$log"],angular.module("app.directives").directive("uploader",uploader),uploader.$inject=["$log","lodash","$timeout","uploaderServ","$stateParams","$http"],angular.module("app.services").factory("uploaderServ",uploaderServ),uploaderServ.$inject=["$http","$q","$log"],angular.module("app.controls").controller("CategoriesCtrl",CategoriesCtrl),CategoriesCtrl.$inject=["$scope","$log","$state","categoriesServ"],angular.module("app.controls").controller("CategoryCtrl",CategoryCtrl),CategoryCtrl.$inject=["$scope","$log","$state","$stateParams","categoriesServ"],angular.module("app.services").factory("categoriesServ",categoriesServ),categoriesServ.$inject=["$http","$q","$log"],angular.module("app.controls").controller("ContentCtrl",ContentCtrl),ContentCtrl.$inject=["$scope","$log","$state","videoServ"],angular.module("app.controls").controller("MainCtrl",MainCtrl),MainCtrl.$inject=["$scope","$log"],angular.module("app.controls").controller("UploadCtrl",UploadCtrl),UploadCtrl.$inject=["$scope","$log"],angular.module("app.controls").controller("VideoCtrl",VideoCtrl),VideoCtrl.$inject=["$scope","$log","$state","$stateParams","videoServ","categoriesServ"],angular.module("app.services").factory("videoServ",videoServ),videoServ.$inject=["$http","$q","$log"],angular.module("app.controls").controller("WatchCtrl",WatchCtrl),WatchCtrl.$inject=["$scope","$stateParams","$sce","$window"];
//# sourceMappingURL=ng.min.js.map
